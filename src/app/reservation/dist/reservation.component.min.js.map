{"version":3,"sources":["reservation.component.ts"],"names":["core_1","require","forms_1","operators_1","ReservationComponent","localeService","fb","modalService","api","loadingService","this","mask","use","Object","defineProperty","prototype","isLoading","ngOnInit","_generateForm","openModal","modalRef","show","modal","submit","_this","data","__assign","form","value","valid","sendmail","pipe","tap","subscribe","group","email","Validators","required","name","phone","adult","children","arrival_date","date_departure","message","rooms","room","__decorate","ViewChild","Component","selector","templateUrl","styleUrls","exports"],"mappings":"+nBAAA,IAAAA,OAAAC,QAAA,iBACAC,QAAAD,QAAA,kBAUAE,YAAAF,QAAA,kBAOAG,qBAAA,WAME,SAAAA,EACUC,EACAC,EACAC,EACAC,EACAC,GAJAC,KAAAL,cAAAA,EACAK,KAAAJ,GAAAA,EACAI,KAAAH,aAAAA,EACAG,KAAAF,IAAAA,EACAE,KAAAD,eAAAA,EARVC,KAAAC,KAAO,qBAULD,KAAKL,cAAcO,IAAI,MA6C3B,OA1CEC,OAAAC,eAAWV,EAAAW,UAAA,YAAS,KAApB,WACE,OAAOL,KAAKD,eAAeO,6CAI7BZ,EAAAW,UAAAE,SAAA,WACEP,KAAKQ,iBAGPd,EAAAW,UAAAI,UAAA,WACET,KAAKU,SAAWV,KAAKH,aAAac,KAAKX,KAAKY,QAI9ClB,EAAAW,UAAAQ,OAAA,WAAA,IAAAC,EAAAd,KACQe,EAAIC,SAAA,GAAQhB,KAAKiB,KAAKC,OACxBlB,KAAKiB,KAAKE,OACZnB,KAAKF,IACFsB,SAASL,GACTM,KACC5B,YAAA6B,IAAI,WAAM,OAAAR,EAAKL,cACfhB,YAAA6B,IAAI,WAAM,OAAAR,EAAKN,mBAEhBe,aAIC7B,EAAAW,UAAAG,cAAR,WACER,KAAKiB,KAAOjB,KAAKJ,GAAG4B,MAAM,CACxBC,MAAO,CAAC,KAAM,CAACjC,QAAAkC,WAAWD,MAAOjC,QAAAkC,WAAWC,WAC5CC,KAAM,CAAC,KAAMpC,QAAAkC,WAAWC,UACxBE,MAAO,CAAC,MAAOrC,QAAAkC,WAAWC,UAC1BG,MAAO,CAAC,KAAMtC,QAAAkC,WAAWC,UACzBI,SAAU,CAAC,MACXC,aAAc,CAAC,KAAMxC,QAAAkC,WAAWC,UAChCM,eAAgB,CAAC,KAAMzC,QAAAkC,WAAWC,UAClCO,QAAS,CAAC,MACVC,MAAOnC,KAAKJ,GAAG4B,MAAM,CACnBY,KAAM,CAAC,WAAY5C,QAAAkC,WAAWC,eArDhBU,WAAA,CAAnB/C,OAAAgD,UAAU,+BADA5C,EAAoB2C,WAAA,CALhC/C,OAAAiD,UAAU,CACTC,SAAU,kBACVC,YAAa,+BACbC,UAAW,CAAC,mCAEDhD,GAAb,GAAaiD,QAAAjD,qBAAAA","file":"reservation.component.min.js","sourcesContent":["import { Component, OnInit, TemplateRef, ViewChild } from '@angular/core';\nimport {\n  FormBuilder,\n  FormGroup,\n  Validators,\n} from '@angular/forms';\nimport { BsModalRef, BsModalService } from 'ngx-bootstrap/modal';\nimport { Observable } from 'rxjs';\nimport { ApiService } from '../services/api.service';\nimport { LoadingService } from '../services/loading.service';\nimport { BsLocaleService } from 'ngx-bootstrap/datepicker';\nimport { tap } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-reservation',\n  templateUrl: './reservation.component.html',\n  styleUrls: ['./reservation.component.scss'],\n})\nexport class ReservationComponent implements OnInit {\n  @ViewChild('modal') modal: TemplateRef<any>;\n  form: FormGroup;\n  mask = '00 (000) 000-00-00';\n  modalRef: BsModalRef;\n\n  constructor(\n    private localeService: BsLocaleService,\n    private fb: FormBuilder,\n    private modalService: BsModalService,\n    private api: ApiService,\n    private loadingService: LoadingService\n  ) {\n    this.localeService.use('ru');\n  }\n\n  public get isLoading(): Observable<boolean> {\n    return this.loadingService.isLoading();\n  }\n\n  // tslint:disable-next-line:typedef\n  ngOnInit() {\n    this._generateForm();\n  }\n\n  openModal() {\n    this.modalRef = this.modalService.show(this.modal);\n  }\n\n  // tslint:disable-next-line:typedef\n  submit(): void {\n    const data = { ...this.form.value };\n    if (this.form.valid) {\n      this.api\n        .sendmail(data)\n        .pipe(\n          tap(() => this.openModal()),\n          tap(() => this._generateForm())\n        )\n        .subscribe();\n    }\n  }\n\n  private _generateForm(): void {\n    this.form = this.fb.group({\n      email: [null, [Validators.email, Validators.required]],\n      name: [null, Validators.required],\n      phone: ['38(', Validators.required],\n      adult: [null, Validators.required],\n      children: [null],\n      arrival_date: [null, Validators.required],\n      date_departure: [null, Validators.required],\n      message: [null],\n      rooms: this.fb.group({\n        room: ['standard', Validators.required],\n      }),\n    });\n  }\n}\n"]}